<!DOCTYPE html>
<!--[if lt IE 7 ]><html lang="en-US" class="no-js ie ie6 lte7 lte8 lte9"><![endif]-->
<!--[if IE 7 ]><html lang="en-US" class="no-js ie ie7 lte7 lte8 lte9"><![endif]-->
<!--[if IE 8 ]><html lang="en-US" class="no-js ie ie8 lte8 lte9"><![endif]-->
<!--[if IE 9 ]><html lang="en-US" class="no-js ie ie9 lte9"><![endif]-->
<!--[if (gt IE 9)|!(IE)]><!--><html lang="en-US" class="no-js"><!--<![endif]-->
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<title>Photo Picker</title>
<meta name="author" content="Eric King" />
<meta name="viewport" content="width=device-width,user-scalable=no, initial-scale=1" />
<script src="https://code.jquery.com/jquery-1.11.1.min.js"></script>
<script src="/js/hogan-3.0.1.js"></script>
<script src="/js/helpers.js"></script>
<script src="/js/lightbox.js"></script>
<script src="/js/PhotoPicker.js"></script>
<script src="/js/InstagramPicker.js"></script>
<script src="/js/FacebookPicker.js"></script>
<script>
var picker,
    fbPicker,
    instagramPicker;

/*
https://developer.mozilla.org/en-US/docs/Web/API/Window.postMessage

IE8/9 do NOT support postMessage between windows.
They only supports it between frame and iframe.

Here is a simple way of passing the token back to this page from a popup.
See callback.html for details.
*/
window.receiveInstagramToken = function( token )
{
    instagramPicker.setAccessToken( token ).open();
};

$(function() {

    picker          = new PhotoPicker;
    fbPicker        = new FacebookPicker;
    // instagramPicker = new InstagramPicker(
    //     "e63a8cb495e94cdebf6c7c16b1b55e20",
    //     "http://photopicker.dev/callback.html"
    // );
    instagramPicker = new InstagramPicker(
        "#instragram-picker",
        "8f9ed714eaff481995467237175e5dfa",
        "https://photopicker.webdeveric.com/callback.html"
    );

    instagramPicker.init();

    var button = $("#instagram-picker-button").on("click", $.proxy( instagramPicker.open, instagramPicker ) );

    var preview = $("#preview");

    $(document).on("photopicker.photo-selected", function( e, url, pickertype ) {
        var img = new Image();
            img.src = url;
        preview.empty().append( img );
    });


    // var facebookContent = new Content("Get photos from Facebook here.");
    // var instagramContent = new AjaxContent("content.html");

    // var InstagramLightbox = new Lightbox(
    //     ".instagram-lightbox",
    //     instagramContent,
    //     {
    //         title: "Choose Photo",
    //         extraClass: "notice"
    //     }
    // );

    // InstagramLightbox.open();

});
</script>
<link type="text/css" rel="stylesheet" href="/css/main.css" />
<link type="text/css" rel="stylesheet" href="/css/lightbox.css" />
</head>
<body>

<div id="content">

    <button id="instagram-picker-button" class="button button-big">Get photo from Instagram</button>

    <div id="preview"></div>

</div>



<div class="lightbox default-lightbox">
    <div class="lightbox-overlay lightbox-close-action"></div>
    <div class="lightbox-frame lightbox-close-action">
        <div class="lightbox-wrapper">
            <div class="lightbox-titlebar">
                <div class="lightbox-title"></div>
                <div class="lightbox-close lightbox-close-action">&times;</div>
            </div>
            <div class="lightbox-content">

            </div>
        </div>
    </div>
</div>


<div class="lightbox instagram-lightbox" id="instagram-lightbox">
    <div class="lightbox-overlay lightbox-close-action"></div>
    <div class="lightbox-frame lightbox-close-action">
        <div class="lightbox-wrapper">
            <div class="lightbox-titlebar">
                <div class="lightbox-title"></div>
                <div class="lightbox-close lightbox-close-action">&times;</div>
            </div>
            <div class="lightbox-content">


            </div>
        </div>
    </div>
</div>

<script type="text/template" id="instragram-picker">
    <div class="picker instagram-picker">
        <div class="row photo-frame">
            <div class="photo-container"></div>
        </div>
        <div class="row actions">
            <button class="button button-cancel">Cancel</button><span class="divider">|</span><button class="button button-load-more" disabled>Load more</button><span class="divider">|</span><button class="button button-submit" disabled>Pick this photo</button>
        </div>
    </div>
</script>

</body>
</html>